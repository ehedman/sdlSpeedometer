#!/bin/bash
ip=$(ifconfig eth0 | grep netmask | awk '{printf $2}')
port=$(cat $(ps -ef | grep lighttpd | awk '/conf/{print $NF}') | awk '/server.port/{print $NF; exit}')
# This example requires that websocketNmea is running on the desired host I.P eth0.
# See: https://github.com/ehedman/websocketNmea

# Temporary profile directory
PROFILE=/tmp/chromium-profile/$(id -u)

# Remove previous profile and create new skeleton
rm -rf "$PROFILE"
mkdir -p "$PROFILE/Default"

# Pre-seed Preferences to disable translation
cat > "$PROFILE/Default/Preferences" <<EOF
{
  "translate": { "enabled": false }
}
EOF

# Launch Chromium in kiosk
exec /usr/bin/chromium \
  --kiosk \
  --no-first-run \
  --password-store=basic \
  --disable-translate \
  --disable-features=TranslateUI \
  --lang=en-US \
  --user-data-dir="$PROFILE" \
  --noerrdialogs \
  --disable-infobars \
  --force-device-scale-factor=0.5 \
  --use-gl=egl \
  --enable-gpu-rasterization \
  http://${ip}:${port}/navi/npanel.php?compact=1
